<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <title>Registro - Lista</title>

        <style>
            table, td, th {
                border:solid;
            }

            .col {
                display: none;
            }
        </style>


        <script src="/html/btp/jquery.js"></script>



        <script>


            function preencheTabela (){

                $.getJSON("/cgi-bin/passmots/registroLista.py", function(data) {

                    console.log(data);
                    var registros = data.registros;

                    var saida = "";

                    for (i = 0; i < registros.length; i++) {

                        saida += "<tr>"
                            saida += "<td class='col0'>"
                                saida += "<a class='historico btn' onclick='abreForm(" + registros[i].codRegistro + ");'>"
                                    saida += registros[i].codRegistro
                                saida += "</a>"
                            saida += "</td>"
                            saida += "<td class='col1'>" + registros[i].codOrigemRegistro + "</td>"
                            saida += "<td class='col2'>" + registros[i].codTipoCampo + "</td>"
                            saida += "<td class='col3'>" + registros[i].ordem + "</td>"
                            saida += "<td class='col4'>" + registros[i].registro.replace(/%r%n/g, "<br>", -1) + "</td>"
                            saida += "<td class='col5'>" + registros[i].dtAtualizacao + "</td>"
                        saida += "</tr>"

                    }


                    saida = saida.replace("%r", "<br>");
                    saida = saida.replace("%n", "<br>");

                    $("tbody").append(saida);
                });
            }

            function abreForm(cod){
                var urlForm = "/html/passmots/registro.html";
                var param = 'cod=' + cod;
                abreNoPrincipal(urlForm, cod, param);
                
            }

            $(document).ready(function() {

                preencheTabela();

            });
        </script>

    </head>

    <body>

        <div class="row-fluid">
                <a href="/html/tarefas/tarefas.html" target="_blank">
                    <h1>Registro - Lista</h1>
                </a>

                <table>
                    <thead>
                        <tr>
                            <th class="col0">codRegistro</th>
                            <th class="col1">codOrigemRegistro</th>
                            <th class="col2">codTipoCampo</th>
                            <th class="col3">ordem</th>
                            <th class="col4">registro</th>
                            <th class="col5">stAtualizacao</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
        </div>

    </body>
</html>
