<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width">
		<title>fechamentoAnual</title>

		<style>
			table, td, th {
				
			}

			.col {
				display: none;
			}
			
			.jumbotron {
				text-align: center;
			}

			.mesAberto{
				background-color: tomato;
			}


		</style>
		<script src="/html/btp/jquery.js"></script>
	</head>
	<body>
.

		<h1>Fechamento Anual</h1>
		<table border="1">
			<tr>
				<td colspan="3">
					<form action="">
						<label for="anoFechamento">Ano de Fechamento</label>
						<input name="anoFechamento" value="2018">
						<button>Alterar</button>
					</form>
				</td>
			</tr>
			<tr>
				<td>
					<a href="/html/financeiro/fechamentoAnual.html?anoFechamento=2017" target="_blank">
						Ano Anterior
					</a>
				</td>
				<td>
					&nbsp;
				</td>
				<td>
					<a href="/html/financeiro/fechamentoAnual.html?anoFechamento=2019" target="_blank">
						Ano Seguinte
					</a>
				</td>
			</tr>
		</table>

		<hr>

<!--=========================================================================-->

		<table border="1" id="tabelaFechamento">
			<thead>
				<tr>
					<th>Mês Ref:</th>
					<th>Receita</th>
					<th>Despesas</th>
					<th>Total</th>
				</tr>
			</thead>
			<tbody></tbody>
			<tfoot>
			</tfoot>
        </table>
        
        <em>* - (R$ *) = Previsão de valores</em>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <hr>
        
        <h2>Gastos do período por tipo de conta</h2>
        
        <table border="1" id="tabelaGastosPorTipoConta" >
			<thead>
	            <tr>
                	<th>Tipo de Conta</th>
            	    <th>Tipo de gasto</th>
        	        <th>Categoria</th>
    	            <th>Ocorrências</th>
	                <th>Total</th>
                	<th>Média p/ Ocorrência</th>
            	</tr>
			</thead>
			<tbody>
	            <tr>
            	    <td>Aluguel</td>
        	        <td>Fixo</td>
    	            <td>Habitação</td>
	                <td>12</td>
                	<td style="text-align: right;">R$ 6.466,06</td>
            	    <td style="text-align: right;">R$ 538,84</td>
        	    </tr>
    	        <tr>
	                <td>Boteco</td>
                	<td>Adicional</td>
            	    <td>Lazer</td>
        	        <td>9</td>
    	            <td style="text-align: right;">R$ 6.311,75</td>
	                <td style="text-align: right;">R$ 701,31</td>
            	</tr>
			</tbody>
			<tfoot></tfoot>
        </table>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <hr>
        
        <h2>Gastos do periodo por Categoria</h2>
        
        <table border="1" id="tabelaGastosPorCategoria">
            <tr>
                <th>
                    Categoria
                </th>
                <th>
                    Tipo de Gasto
                </th>
                <th>
                    Total
                </th>
                <th>
                    Porcentagem
                </th>
            </tr>
            <tr>
                <td>
                    <span title="Feira/Padaria/Supermercado">
                        Alimentação
                    </span>
                </td>
                <td>
                    <span title="Aquelas que acontecem todos os meses, mas podemos tentar reduzir">
                        Variável
                    </span>
                </td>
                <td>
                    R$ 253,47
                </td>
                <td>
                    0,44 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Academia/Cabeleireiro/Clube/Cosméticos/Esteticista/Manicure">
                        Cuidados pessoais
                    </span>
                </td>
                <td>
                    <span title="Aquelas que acontecem todos os meses, mas podemos tentar reduzir">
                        Variável
                    </span>
                </td>
                <td>
                    R$ 25,00
                </td>
                <td>
                    0,04 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Colégio/Curso/Faculdade">
                        Educação
                    </span>
                </td>
                <td>
                    <span title="Aquelas que têm o mesmo montante mensalmente e não pode ser cortado do orçamento.">
                        Fixo
                    </span>
                </td>
                <td>
                    R$ 522,00
                </td>
                <td>
                    0,90 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Aluguel/Condomínio/Diarista/Mensalista/Prestação da casa/Seguro da casa">
                        Habitação
                    </span>
                </td>
                <td>
                    <span title="Aquelas que têm o mesmo montante mensalmente e não pode ser cortado do orçamento.">
                        Fixo
                    </span>
                </td>
                <td>
                    R$ 6.466,06
                </td>
                <td>
                    11,18 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Gás/Internet/Luz/Mensalidade TV/Telefone/Telefone Celular/Água">
                        Habitação
                    </span>
                </td>
                <td>
                    <span title="Aquelas que acontecem todos os meses, mas podemos tentar reduzir">
                        Variável
                    </span>
                </td>
                <td>
                    R$ 4.390,48
                </td>
                <td>
                    7,59 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Cinema/teatro/Locadora DVD/Restaurantes/bares/Viagens">
                        Lazer
                    </span>
                </td>
                <td>
                    <span title="Aquelas que não precisam acontecer todos os meses podem ser cortadas, mesmo que sejam por um tempo.">
                        Adicional
                    </span>
                </td>
                <td>
                    R$ 6.311,75
                </td>
                <td>
                    10,91 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Pagamentos/Pensão Alimentícia/Seguro de vida">
                        Outros
                    </span>
                </td>
                <td>
                    <span title="Aquelas que têm o mesmo montante mensalmente e não pode ser cortado do orçamento.">
                        Fixo
                    </span>
                </td>
                <td>
                    R$ 12.810,98
                </td>
                <td>
                    22,14 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Outros - inesperado">
                        Outros
                    </span>
                </td>
                <td>
                    <span title="São as despesas extraordinárias, para as quais precisamos estar preparados quando acontecerem.">
                        Extra
                    </span>
                </td>
                <td>
                    R$ 110,00
                </td>
                <td>
                    0,19 %
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Combustível/Estacionamento/Metrô/Ônibus">
                        Transporte
                    </span>
                </td>
                <td>
                    <span title="Aquelas que acontecem todos os meses, mas podemos tentar reduzir">
                        Variável
                    </span>
                </td>
                <td>
                    R$ 2.147,00
                </td>
                <td>
                    3,71 %
                </td>
            </tr>
            <tr>
                <td>Diferença de receita</td>
                <td>&nbsp;</td>
                <td>R$ 24.814,32</td>
                <td>
                    42,89 %
                </td>
            </tr>
        </table>
        <br>
        <table border="1">
            <tr>
                <th>
                    Categorias Não Listadas
                </th>
            </tr>
            <tr>
                <td>
                    <span title="Feira/Padaria/Supermercado">
                        Alimentação
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Academia/Cabeleireiro/Clube/Cosméticos/Esteticista/Manicure">
                        Cuidados pessoais
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Colégio/Curso/Faculdade/Material escolar/Uniforme">
                        Educação
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Aluguel/Condomínio/Diarista/Gás/Internet/Luz/Mensalidade TV/Mensalista/Prestação da casa/Seguro da casa/Telefone/Telefone Celular/Água">
                        Habitação
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="IPTU/IPVA">
                        Impostos
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="">
                        Investimentos
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Cinema/teatro/Locadora DVD/Restaurantes/bares/Viagens">
                        Lazer
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Carro/Casa">
                        Manutenção/Prevenção
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Outros/Outros - inesperado/Pagamentos/Pensão Alimentícia/Presentes/Seguro de vida">
                        Outros
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Dentista/Hospital/Medicamentos/Médico/Plano de saúde/Seguro saúde">
                        Saúde
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Materiais">
                        Trabalho
                    </span>
                    
                </td>
            </tr>
            <tr>
                <td>
                    <span title="Acessórios/Calçados/Roupas">
                        Vestuário
                    </span>
                    
                </td>
            </tr>
        </table>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <hr>
        
        <h2>Gastos do periodo por Tipo de gasto</h2>
        
        <table border="1">
            <tr>
                <th>
                    Tipo de gasto
                </th>
            </tr>
            <tr>
                <td>
                    Tipo de gasto
                </td>
            </tr>
        </table>
        
        
        
        
        
        
        
        
        
        
        <br><br><br><br><br><br><br>
    </body>
</html>

































		<script>



			function preencheFechamentoAnual(anoFechamento){
				var saida = "";

				url = "/cgi-bin/financeiro/fechamentoAnual.py";

				url += "?anoFechamento=" + anoFechamento;

				$.getJSON(url, 
					function(data) {
						//console.log(data);
						let lista = data.fechamentoAnual;
						let saida = "";
						let tdClass = "mesAberto";

						for (i = 0; i < lista.length; i++) {
							obj = lista[i];

							tdClass = "mesAberto";

							if (obj.ttlReceita > 0) {
								tdClass = "mesFechado"
							}

							saida += 
								"<tr>" +
									"<td class='" + tdClass + "'>" +
										"<a " + 
											"href='/html/financeiro/" + 
											"contasPeloPagamento.html?dtRef=" + 
											obj.dtRef + "' target='_blank'" +
										">" +
											obj.dtRef.substring(5, 7) + "/" +
											obj.dtRef.substring(0, 4) +
										"</a>" +
									"</td>";

							if (obj.ttlReceita > 0) {
								saida += 
									"<td class='" + tdClass + "' " + 
										"style='text-align: right;'>R$ " + 
										obj.ttlReceita + 
									"</td>" +
									"<td class='" + tdClass + "' " + 
										"style='text-align: right;'>R$ " + 
										obj.ttlDespesa + 
									"</td>" +
									"<td class='" + tdClass + "' " + 
										"style='text-align: right;'>R$ " + 
										obj.ttlTotal + 
									"</td>"; 
							} else {
								saida += 
									"<td class='" + tdClass + "' " + 
										"style='text-align: right;'>R$ " + 
										obj.ttlReceitaPrev + 
									"</td>" +
									"<td class='" + tdClass + "' " + 
										"style='text-align: right;'>R$ " + 
										obj.ttlDespesaPrev + 
									"</td>" +
									"<td class='" + tdClass + "' " + 
										"style='text-align: right;'>R$ " + 
										obj.ttlTotalPrev + 
									"</td>"; 
							}

							saida += "</tr>";
						}

						$("#tabelaFechamento tbody").append(saida);
					}
				);
			}





















			$(document).ready(function () {
		
				let anoFechamento = 2019;

				let params = window.location.search;
		
//				let params = decodeURI(
//					$("#categoriaContaCmb").parent().parent().attr('param')
//				);

				let searchParams = new URLSearchParams(params);
		
				if (searchParams.has("anoFechamento")){
					anoFechamento = searchParams.get("anoFechamento");
				}

				preencheFechamentoAnual(anoFechamento);

				$("#tabelaGastosPorTipoConta").css("display", "none");
				$("#tabelaGastosPorCategoria").css("display", "none");


			});



		</script>
	</body>
</html>

